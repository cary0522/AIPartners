<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./css/style.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://kit.fontawesome.com/5292bd8fe4.js" crossorigin="anonymous"></script>
    <title>Partners</title>
</head>

<body>
    <div class="header-page"></div>
    <div class="modal fade" data-bs-backdrop="static" tabindex="-1" id="liveModal">
        <div class="modal-dialog modal-sm">
            <div class="modal-content">
                <p class="pt-3 mx-1 fs-3">喜歡您的寵物嗎？</p>
                <p class="pb-3 mx-1 fs-3">一起來解鎖更多寵物！</p>
                <div class="modal-footer d-flex justify-content-evenly py-3">
                    <button class="btn border rounded" type="button" data-bs-dismiss="modal">稍後解鎖</button>
                    <a href="./premiumpage.html" class="btn border rounded">前往解鎖</a>
                </div>
            </div>
        </div>
</div>
    <div class="partnerspage container-fluid">
        <div class="grid-container">
            <div class="grid-item grid-item1">
                <h2 class="py-3">夥伴基本資料</h2>
                <div class="d-flex justify-content-center">
                    <p class="fs-4">夥伴姓名：</p>
                    <p id="partner-name" class="fs-4"></p>
                </div>
                <div id="photo"></div>

            </div>

            <div class="flex-lg-column grid-item grid-item2">
                <div class="col-lg-12 p-3" id="info"></div>
                <div class="col-12">

                    <h2 class="py-3">
                        來跟你的夥伴互動吧！
                    </h2>


                    <div class="container col-12 col-lg-8 mx-auto my-2">
                        <div class="iphone bg-white w-100 position-relative">
                            <div class="d-flex justify-content-between px-3 py-1">
                                <div>
                                    <p>AI partners</p>
                                </div>
                                <div>
                                    <i class="fa-solid fa-wifi mx-1"></i>
                                    <i class="fa-solid fa-signal mx-1"></i>
                                    <i class="fa-solid fa-battery-full mx-1"></i>
                                </div>
                            </div>
                            <div class="container-fluid text-start fs-3" id="interactive-partner-name"></div>
                            <div class="py-3 my-2" id="interactive-partner-feedback">
                                <div class="d-flex justify-content-start">
                                    <div class="iphone-pic ms-2" id="interactive-partner-photo"></div>
                                    <div class="position-relative">
                                        <p class="partner-text">Hi</p>
                                    </div>
                                </div>
                            </div>
                            <div class="col-10 mx-auto d-flex flex-nowrap" id="interactive">
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="love-card">
                                    <i class="fa-solid fa-hand-holding-heart"></i>
                                    <div class="card-text ">關心</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="money-card">
                                    <i class="fa-solid fa-hand-holding-dollar"></i>
                                    <div class="card-text">零用錢</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="command-card">
                                    <i class="fa-solid fa-thumbs-up"></i>
                                    <div class="card-text">稱讚</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="eating-card">
                                    <i class="fa-solid fa-utensils"></i>
                                    <div class="card-text">餵食</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="water-card">
                                    <i class="fa-solid fa-droplet"></i>
                                    <div class="card-text">喝水</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="wash-card">
                                    <i class="fa-solid fa-shower"></i>
                                    <div class="card-text">洗澡</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="play-card">
                                    <i class="fa-solid fa-gamepad"></i>
                                    <div class="card-text">玩耍</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="hand-out-card">
                                    <i class="fa-solid fa-person-walking"></i>
                                    <div class="card-text">散步</div>
                                </div>
                                <div class="m-1 px-2 py-4 col-3 options-behaviors" id="toilet-card">
                                    <i class="fa-solid fa-toilet"></i>
                                    <div class="card-text">廁所</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="grid-item grid-item3">
                <div class="container-fluid py-2 d-flex flex-wrap">
                    <div class="col-12 p-2 achievement-progress progress-love">
                        <div class="card">
                            <i class="fa-solid fa-hand-holding-heart my-2"></i>
                            <div class="card-text my-1">關心</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="love-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-money">
                        <div class="card">
                            <i class="fa-solid fa-hand-holding-dollar my-2"></i>
                            <div class="card-text my-1">零用錢</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="money-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-command">
                        <div class="card">
                            <i class="fa-solid fa-thumbs-up my-2"></i>
                            <div class="card-text my-1">稱讚</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="command-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-eating">
                        <div class="card">
                            <i class="fa-solid fa-utensils my-2"></i>
                            <div class="card-text my-1">餵食</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="eating-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-water">
                        <div class="card">
                            <i class="fa-solid fa-droplet my-2"></i>
                            <div class="card-text my-1">喝水</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="water-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-wash">
                        <div class="card">
                            <i class="fa-solid fa-shower my-2"></i>
                            <div class="card-text my-1">洗澡</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="wash-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-play">
                        <div class="card">
                            <i class="fa-solid fa-gamepad my-2"></i>
                            <div class="card-text my-1">玩耍</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="play-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-hand-out">
                        <div class="card">
                            <i class="fa-solid fa-person-walking my-2"></i>
                            <div class="card-text my-1">散步</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="hand-out-progress-bar"></div>
                        </div>
                    </div>
                    <div class="col-12 p-2 achievement-progress progress-toilet">
                        <div class="card">
                            <i class="fa-solid fa-toilet my-2"></i>
                            <div class="card-text my-1">廁所</div>
                        </div>
                        <div class="progress">
                            <div class="progress-bar bg-danger" style="width: 0%;" id="toilet-progress-bar"></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

    </div>
    <div>
        <button type="button" id="clear">clear</button>
    </div>




    <div class="footer-page"></div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy" crossorigin="anonymous">
    </script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"
        integrity="sha256-eKhayi8LEQwp4NKxN+CfCh+3qOVUtJn3QNZ0TciWLP4=" crossorigin="anonymous"></script>
    <script>
        $('.header-page').load('header.html');
        $('.footer-page').load('footer.html');

        let partner_name = localStorage.getItem('partnerName');
        let partner_trait = localStorage.getItem('partnerTrait');
        let partnerTraitArr = JSON.parse(partner_trait);
        let partner_appearance = localStorage.getItem('partnerAppearance');
        let partnerAppearanceArr = JSON.parse(partner_appearance);
        console.log(partnerTraitArr);
        console.log(partnerAppearanceArr);

        let partnerName = document.getElementById('partner-name');
        partnerName.innerText = partner_name;
        let interactivePartnerName = document.getElementById('interactive-partner-name')
        interactivePartnerName.innerText = partner_name;

        let photoSrc = [
            'partners_photo/0000.jpg',
            'partners_photo/0001.jpg',
            'partners_photo/0010.jpg',
            'partners_photo/0011.jpg',
            'partners_photo/0100.jpg',
            'partners_photo/0101.jpg',
            'partners_photo/0110.jpg',
            'partners_photo/0111.jpg',
            'partners_photo/1000.jpg',
            'partners_photo/1001.jpg',
            'partners_photo/1010.jpg',
            'partners_photo/1011.jpg',
            'partners_photo/1100.jpg',
            'partners_photo/1101.jpg',
            'partners_photo/1110.jpg',
            'partners_photo/1111.jpg',
        ]
        let photo = document.getElementById('photo');
        let interactivePartnerPhoto = document.getElementById('interactive-partner-photo')


        let info = document.getElementById('info');
        info.innerHTML = ` 
        <p class='fs-4'> ${partner_name}，是一位${partnerTraitArr[0]}、${partnerTraitArr[1]}、${partnerTraitArr[2]}，而且喜愛${partnerTraitArr[3]}的夥伴！ </p>
        `

        if (partnerAppearanceArr.toString() == ['毛絨可愛', '大眼睛', '大耳朵', '身強體壯'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[0]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[0]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['毛絨可愛', '大眼睛', '大耳朵', '瘦小可愛'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[1]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[1]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['毛絨可愛', '大眼睛', '小耳朵', '身強體壯'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[2]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[2]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['毛絨可愛', '大眼睛', '小耳朵', '瘦小可愛'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[3]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[3]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['毛絨可愛', '小眼睛', '大耳朵', '身強體壯'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[4]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[4]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['毛絨可愛', '小眼睛', '大耳朵', '瘦小可愛'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[5]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[5]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['毛絨可愛', '小眼睛', '小耳朵', '身強體壯'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[6]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[6]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['毛絨可愛', '小眼睛', '小耳朵', '瘦小可愛'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[7]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[7]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['現代機械', '大眼睛', '大耳朵', '身強體壯'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[8]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[8]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['現代機械', '大眼睛', '大耳朵', '瘦小可愛'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[9]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[9]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['現代機械', '大眼睛', '小耳朵', '身強體壯'].toString()) {
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[10]}" alt="" class="rounded-circle flex-shrink-0">`
            photo.innerHTML = `<img src='${photoSrc[10]}' alt=''>`
        } else if (partnerAppearanceArr.toString() == ['現代機械', '大眼睛', '小耳朵', '瘦小可愛'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[11]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[11]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['現代機械', '小眼睛', '大耳朵', '身強體壯'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[12]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[12]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['現代機械', '小眼睛', '大耳朵', '瘦小可愛'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[13]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[13]}" alt="" class="rounded-circle flex-shrink-0">`
        } else if (partnerAppearanceArr.toString() == ['現代機械', '小眼睛', '小耳朵', '身強體壯'].toString()) {
            photo.innerHTML = `<img src='${photoSrc[14]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[14]}" alt="" class="rounded-circle flex-shrink-0">`
        } else {
            photo.innerHTML = `<img src='${photoSrc[15]}' alt=''>`
            interactivePartnerPhoto.innerHTML =
                `<img src="${photoSrc[15]}" alt="" class="rounded-circle flex-shrink-0">`
        }

        let feedback = [];
        if (partnerTraitArr[0] == '活潑') {
            feedback[0] = '耶！我最喜歡您！'
        } else {
            feedback[0] = '謝謝您總是協助我'
        }
        if (partnerTraitArr[1] == '理性') {
            feedback[1] = '請提供我必要協助'
        } else {
            feedback[1] = '謝謝您，我好感動'
        }
        if (partnerTraitArr[2] == '謹慎') {
            feedback[2] = '小心點，別受傷了'
        } else {
            feedback[2] = '超刺激！我喜歡！'
        }
        if (partnerTraitArr[3] == '戶外活動') {
            feedback[3] = '帶我去戶外走走吧'
        } else {
            feedback[3] = '我們一起待在家吧'
        }

        console.log(feedback);
        let interactivePartnerFeedback = document.getElementById('interactive-partner-feedback')

        let behaviors = ['關心', '零用錢', '稱讚', '餵食', '喝水', '洗澡', '玩耍', '散步', '廁所']
        let cardTimes = [0, 0, 0, 0, 0, 0, 0, 0, 0]
        let achi = document.getElementById('achi')

        function progressBarWidth(e) {
            let n = behaviors.indexOf(e.innerText)
            let progressBar = document.getElementsByClassName('progress-bar')
            let achievementProgress = document.getElementsByClassName('achievement-progress')
            cardTimes[n] += 1
            achievementProgress[n].style.display = 'block'
            setTimeout(() => {
                achievementProgress[n].style.display = 'none'
            }, 3000)
            progressBar[n].style.width = cardTimes[n] * 20 + '%'
            let randomNum = Math.floor(Math.random() * feedback.length)
            interactivePartnerFeedback.innerHTML += `
                        <div class="d-flex justify-content-between">
                            <div class="ms-5 position-relative">
                                <p class="partner-text textFeedback">${feedback[randomNum]}</p>
                            </div>
                        </div>
                        `
            interactivePartnerFeedback.scrollTo(0, interactivePartnerFeedback.scrollHeight)


            let textFeedback = document.querySelectorAll('.textFeedback')
            setTimeout(() => {
                textFeedback[0].classList.remove('textFeedback')
            }, 3000)

            let sum = 0
            cardTimes.forEach((x) => {
                sum += x
            })
            let liveModal = document.querySelector('#liveModal')
            const modal = new bootstrap.Modal(liveModal)
            if (sum == 5) {
                modal.show()
            }
        }

        let card = document.querySelectorAll('.options-behaviors')
        for (let i = 0; i < behaviors.length; i++) {
            card[i].addEventListener('click', function () {
                progressBarWidth(this)
            })
        }

        // 清空localStorage
        let btnClear = document.getElementById('clear')
        btnClear.addEventListener('click', function () {
            console.log(clear)
            localStorage.setItem('partnerTrait', null)
            localStorage.setItem('partnerAppearance', null)
            localStorage.setItem('partnerName', null)

        })
    </script>
</body>

</html>